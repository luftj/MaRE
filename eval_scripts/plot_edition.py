edition_list = "E:/data/deutsches_reich/wiki/highres/edition_list.txt"
edition_list = "E:/data/deutsches_reich/SLUB/cut/editions.txt"

sheet_names = ["529",#"12",
                "3","4","5",
                "6","7","8","9","10-18",
                "11",#"79a",
                "168","173","259",
                "327","328","329","330","331",
                "332","333","352","353","354",
                "355","356","357","358","377",
                "378","379","381","382","383",
                "402","403","404","405","406",
                "407","408","428","429","430",
                "431","432","433","434","571",
                "572","581","602","380"]
#["529","12","3","4","5","6","7","8","9","10","11","79a","168","173","259","327","328","382","383"]
error_results = [127.425356, # 808.127598,
                 405.070386, 349.664682, 509.326544, 
                 1977.204952, 499.567129, 333.353408, 114.199929, 347.203024, 
                 164.871981, # 18179.592263, 
                 191.158490,  75.028294, 52.330538, 
                 102.093746,  121.107682,  2067.600979, 92.453029, 1543.557139, 
                 91.655742,   51.111890,   129.926327, 87.675772, 171.246463, 
                 61.944273,   77.858277,   58.707810, 275.575773, 107.694777, 
                 1601.318240, 84.639471,   126.455419, 87.476919, 119.161954, 
                 1690.922109, 1239.491436, 62.393875, 126.555694, 99.391196, 
                 77.121876,   100.562299,  140.500505, 89.768985, 69.173359, 
                 64.417055,   73.200442,   83.135307, 64.073825, 1424.003588, 
                 85.241935,   82.453438,   73.992250, 58.626446]

res = {
"161" : 0,
"162" : 0,
"163" : 0,
"164" : 0,
"165" : 0,
"166" : 0,
"167" : 0,
"168" : 0,
"169" : 0,
"170" : 0,
"171" : 0,
"172" : 122,
"173" : 27,
"174" : 140,
"175" : 0,
"176" : 35,
"177" : 72,
"178" : 8,
"179" : 3,
"180" : 3,
"181" : 269,
"182" : 0,
"183" : 0,
"184" : 1,
"185" : 0,
"186" : 0,
"187" : 3,
"188" : 0,
"189" : 0,
"190" : 0,
"191" : 0,
"192" : 0,
"193" : 0,
"194" : 0,
"195" : 0,
"196" : 0,
"197" : 0,
"198" : 0,
"199" : 196,
"200" : 1,
"201" : 92,
"203" : 17,
"204" : 2,
"205" : 39,
"206" : 0,
"207" : 3,
"208" : 218,
"209" : 186,
"210" : 146,
"211" : 19,
"212" : 14,
"213" : 703,
"214" : 0,
"215" : 0,
"216" : 0,
"217" : 0,
"218" : 1,
"219" : 0,
"220" : 0,
"221" : 0,
"222" : 0,
"223" : 0,
"224" : 26,
"225" : 0,
"226" : 0,
"227" : 3,
"228" : 0,
"229" : 618,
"231" : 42,
"232" : 660,
"233" : 266,
"234" : 47,
"235" : 0,
"236" : 1,
"237" : 703,
"238" : 16,
"239" : 317,
"240" : 10,
"241" : 1,
"242" : 0,
"243" : 0,
"244" : 0,
"245" : 0,
"246" : 0,
"247" : 0,
"248" : 0,
"249" : 0,
"250" : 67,
"251" : 0,
"252" : 0,
"253" : 0,
"254" : 34,
"255" : 20,
"256" : 11,
"257" : 9,
"258" : 6,
"259" : 5,
"270" : 0,
"271" : 6,
"272" : 0,
"273" : 0,
"274" : 0,
"275" : 0,
"276" : 0,
"277" : 0,
"278" : 0,
"279" : 96,
"280" : 312,
"281" : 4,
"282" : 6,
"283" : 78,
"284" : 496,
"285" : 8,
"286" : 1,
"287" : 238,
"288" : 6,
"289" : 848,
"290" : 7,
"291" : 2,
"292" : 0,
"293" : 0,
"294" : 0,
"295" : 0,
"296" : 0,
"297" : 0,
"298" : 0,
"299" : 0,
"300" : 0,
"301" : 0,
"302" : 26,
"303" : 0,
"304" : 735,
"305" : 131,
"306" : 6,
"307" : 769,
"308" : 197,
"309" : 1,
"310" : 40,
"311" : 143,
"312" : 67,
"313" : 20,
"314" : 3,
"315" : 22,
"316" : 792,
"317" : 19,
"318" : 0,
"319" : 0}

res = {"161" : 0,
"162" : 0,
"163" : 1,
"164" : 0,
"165" : 0,
"166" : 0,
"167" : 0,
"168" : 0,
"169" : 0,
"170" : 0,
"171" : 0,
"172" : 562,
"173" : 73,
"174" : 155,
"175" : 0,
"176" : 175,
"177" : 109,
"178" : 36,
"179" : 11,
"180" : 8,
"181" : 31,
"182" : 0,
"183" : 0,
"184" : 0,
"185" : 0,
"186" : 0,
"187" : 4,
"188" : 0,
"189" : 0,
"190" : 0,
"191" : 0,
"192" : 0,
"193" : 0,
"194" : 0,
"195" : 1,
"196" : 0,
"197" : 0,
"198" : 0,
"199" : 220,
"200" : 3,
"201" : 117,
"203" : 18,
"204" : 7,
"205" : 19,
"206" : 0,
"207" : 7,
"208" : 161,
"209" : 5,
"210" : 11,
"211" : 87,
"212" : 30,
"213" : 819,
"214" : 0,
"215" : 0,
"216" : 0,
"217" : 0,
"218" : 0,
"219" : 0,
"220" : 0,
"221" : 0,
"222" : 0,
"223" : 0,
"224" : 111,
"225" : 0,
"226" : 0,
"227" : 0,
"228" : 0,
"229" : 691,
"231" : 47,
"232" : 681,
"233" : 283,
"234" : 26,
"235" : 0,
"236" : 4,
"237" : 174,
"238" : 6,
"239" : 276,
"240" : 2,
"241" : 2,
"242" : 0,
"243" : 0,
"244" : 0,
"245" : 0,
"246" : 0,
"247" : 0,
"248" : 0,
"249" : 0,
"250" : 146,
"251" : 0,
"252" : 0,
"253" : 0,
"254" : 5,
"255" : 64,
"256" : 12,
"257" : 1,
"258" : 3,
"259" : 3,
"270" : 0,
"271" : 2,
"272" : 0,
"273" : 0,
"274" : 0,
"275" : 0,
"276" : 0,
"277" : 0,
"278" : 0,
"279" : 1,
"280" : 166,
"281" : 8,
"282" : 3,
"283" : 92,
"284" : 335,
"285" : 7,
"286" : 4,
"287" : 347,
"288" : 1,
"289" : 203,
"290" : 10,
"291" : 0,
"292" : 0,
"293" : 0,
"294" : 0,
"295" : 0,
"296" : 0,
"297" : 0,
"298" : 0,
"299" : 0,
"300" : 0,
"301" : 0,
"302" : 33,
"303" : 0,
"304" : 335,
"305" : 184,
"306" : 2,
"307" : 12,
"308" : 2,
"309" : 1,
"310" : 51,
"311" : 35,
"312" : 46,
"313" : 13,
"314" : 2,
"315" : 28,
"316" : 277,
"317" : 8,
"318" : 0,
"319" : 0}

res = {"161" : 0,
"162" : 0,
"163" : 0,
"164" : 0,
"165" : 0,
"166" : 0,
"167" : 0,
"168" : 0,
"169" : 0,
"170" : 0,
"171" : 0,
"172" : 204,
"173" : 98,
"174" : 243,
"175" : 0,
"176" : 144,
#"177" : -1,
"178" : 0,
"179" : 13,
"180" : 8,
"181" : 6,
"182" : 0,
"183" : 0,
"184" : 0,
"185" : 0,
"186" : 0,
"187" : 4,
"188" : 0,
"189" : 0,
"190" : 0,
"191" : 0,
"192" : 0,
"193" : 0,
"194" : 0,
"195" : 0,
"196" : 0,
"197" : 0,
"198" : 0,
"199" : 178,
"200" : 15,
"201" : 66,
"203" : 14,
"204" : 2,
"205" : 21,
"206" : 0,
"207" : 2,
#"208" : -1,
"209" : 3,
"210" : 7,
"211" : 74,
"212" : 11,
"213" : 798,
"214" : 0,
"215" : 0,
"216" : 0,
"217" : 1,
"218" : 0,
"219" : 0,
"220" : 0,
"221" : 0,
"222" : 0,
"223" : 0,
"224" : 145,
"225" : 0,
"226" : 0,
"227" : 0,
"228" : 0,
"229" : 839,
"231" : 33,
"232" : 638,
"233" : 337,
"234" : 26,
"235" : 0,
#"236" : -1,
"237" : 269,
"238" : 1,
"239" : 301,
"240" : 1,
"241" : 0,
"242" : 0,
"243" : 0,
"244" : 0,
"245" : 0,
"246" : 0,
"247" : 0,
"248" : 0,
"249" : 0,
"250" : 104,
"251" : 0,
"252" : 0,
"253" : 0,
"254" : 10,
"255" : 47,
"256" : 5,
"257" : 1,
"258" : 3,
"259" : 4,
"270" : 0,
"271" : 0,
"272" : 0,
"273" : 0,
"274" : 0,
"275" : 0,
"276" : 0,
"277" : 0,
"278" : 0,
"279" : 0,
"280" : 262,
"281" : 3,
"282" : 1,
"283" : 109,
"284" : 436,
"285" : 3,
#"286" : -1,
"287" : 246,
"288" : 2,
"289" : 236,
"290" : 0,
"291" : 0,
"292" : 0,
"293" : 0,
"294" : 0,
"295" : 0,
"296" : 0,
"297" : 0,
"298" : 0,
"299" : 0,
"300" : 0,
"301" : 0,
"302" : 42,
"303" : 0,
"304" : 433,
"305" : 64,
"306" : 1,
"307" : 0,
"308" : 0,
"309" : 0,
#"310" : -1,
"311" : 46,
"312" : 36,
"313" : 31,
"314" : 0,
"315" : 0,
"316" : 252,
"317" : 8,
"318" : 0,
"319" : 0}

res = {"161" : 0,
"162" : 0,
"163" : 1,
"164" : 0,
"165" : 0,
"166" : 0,
"167" : 0,
"168" : 0,
"169" : 0,
"170" : 0,
"171" : 0,
"172" : 38,
"173" : 6,
"174" : 139,
"175" : 1,
"176" : 87,
"177" : 69,
"178" : 0,
"179" : 74,
"180" : 6,
"181" : 5,
"182" : 0,
"183" : 0,
"184" : 0,
"185" : 0,
"186" : 0,
"187" : 5,
"188" : 0,
"189" : 0,
"190" : 0,
"191" : 0,
"192" : 0,
"193" : 0,
"194" : 0,
"195" : 0,
"196" : 0,
"197" : 0,
"198" : 0,
"199" : 160,
"200" : 9,
"201" : 69,
"203" : 3,
"204" : 5,
"205" : 8,
"206" : 0,
"207" : 0,
"208" : 30,
"209" : 0,
"210" : 1,
"211" : 223,
"212" : 25,
"213" : 830,
"214" : 0,
"215" : 0,
"216" : 0,
"217" : 0,
"218" : 0,
"219" : 0,
"220" : 0,
"221" : 0,
"222" : 0,
"223" : 0,
"224" : 144,
"225" : 0,
"226" : 0,
"227" : 0,
"228" : 0,
"229" : 880,
"231" : 9,
"232" : 88,
"233" : 52,
"234" : 3,
"235" : 0,
"236" : 0,
"237" : 190,
"238" : 16,
"239" : 81,
"240" : 1,
"241" : 0,
"242" : 0,
"243" : 0,
"244" : 0,
"245" : 0,
"246" : 0,
"247" : 0,
"248" : 0,
"249" : 0,
"250" : 27,
"251" : 0,
"252" : 0,
"253" : 0,
"254" : 28,
"255" : 24,
"256" : 2,
"257" : 1,
"258" : 2,
"259" : 0,
"270" : 0,
"271" : 0,
"272" : 0,
"273" : 0,
"274" : 0,
"275" : 0,
"276" : 0,
"277" : 0,
"278" : 0,
"279" : 0,
"280" : 173,
"281" : 4,
"282" : 1,
"283" : 84,
"284" : 8,
"285" : 2,
"286" : 2,
"287" : 302,
"288" : 1,
"289" : 190,
"290" : 0,
"291" : 0,
"292" : 0,
"293" : 0,
"294" : 0,
"295" : 0,
"296" : 0,
"297" : 0,
"298" : 0,
"299" : 0,
"300" : 0,
"301" : 0,
"302" : 0,
"303" : 0,
"304" : 379,
"305" : 20,
"306" : 0,
"307" : 19,
"308" : 0,
"309" : 0,
"310" : 10,
"311" : 97,
"312" : 8,
"313" : 7,
"314" : 0,
"315" : 0,
"316" : 10,
"317" : 1,
"318" : 0,
"319" : 0}

res = {"161" : 0,
"162" : 0,
"163" : 1,
"164" : 0,
"165" : 0,
"166" : 0,
"167" : 0,
"168" : 0,
"169" : 0,
"170" : 0,
"171" : 0,
"172" : 27,
"173" : 3,
"174" : 65,
"175" : 1,
"176" : 66,
"177" : 24,
"178" : 0,
"179" : 114,
"180" : 16,
"181" : 6,
"182" : 0,
"183" : 0,
"184" : 0,
"185" : 0,
"186" : 0,
"187" : 5,
"188" : 0,
"189" : 0,
"190" : 0,
"191" : 0,
"192" : 0,
"193" : 0,
"194" : 0,
"195" : 0,
"196" : 0,
"197" : 0,
"198" : 0,
"199" : 153,
"200" : 9,
"201" : 120,
"203" : 5,
"204" : 2,
"205" : 0,
"206" : 0,
"207" : 0,
"208" : 20,
"209" : 0,
"210" : 2,
"211" : 235,
"212" : 4,
"213" : 840,
"214" : 0,
"215" : 0,
"216" : 0,
"217" : 0,
"218" : 0,
"219" : 0,
"220" : 0,
"221" : 0,
"222" : 0,
"223" : 0,
"224" : 116,
"225" : 0,
"226" : 0,
"227" : 0,
"228" : 0,
"229" : 762,
"231" : 3,
"232" : 18,
"233" : 7,
"234" : 2,
"235" : 0,
"236" : 0,
"237" : 209,
"238" : 0,
"239" : 50,
"240" : 1,
"241" : 0,
"242" : 0,
"243" : 0,
"244" : 0,
"245" : 0,
"246" : 0,
"247" : 0,
"248" : 0,
"249" : 0,
"250" : 58,
"251" : 0,
"252" : 0,
"253" : 0,
"254" : 26,
"255" : 67,
"256" : 0,
"257" : 0,
"258" : 0,
"259" : 0,
"270" : 0,
"271" : 0,
"272" : 0,
"273" : 0,
"274" : 0,
"275" : 0,
"276" : 0,
"277" : 0,
"278" : 0,
"279" : 0,
"280" : 153,
"281" : 1,
"282" : 0,
"283" : 34,
"284" : 10,
"285" : 0,
"286" : 0,
"287" : 146,
"288" : 0,
"289" : 63,
"290" : 0,
"291" : 0,
"292" : 0,
"293" : 0,
"294" : 0,
"295" : 0,
"296" : 0,
"297" : 0,
"298" : 0,
"299" : 0,
"300" : 0,
"301" : 0,
"302" : 0,
"303" : 0,
"304" : 688,
"305" : 8,
"306" : 0,
"307" : 26,
"308" : 1,
"309" : 0,
"310" : 39,
"311" : 20,
"312" : 5,
"313" : 0,
"314" : 0,
"315" : 0,
"316" : 2,
"317" : 1,
"318" : 0,
"319" : 0}

sheet_names = list(res.keys())
error_results = list(res.values())
# error_results = [x+10 for x in error_results]

editions = {}
with open(edition_list) as fr:
    for line in fr:
        line=line.strip()
        name,edition = line.split(",")
        edition=edition.strip()
        editions[name] = edition

# print(editions)


total_mean_error = sum(error_results)/len(error_results)
print("total mean error: %f m" % total_mean_error)

results_sorted = sorted(zip(sheet_names,error_results), key=lambda tup: tup[1])
sheet_names_sorted = [x[0] for x in results_sorted]
error_sorted = [x[1] for x in results_sorted]

median_error = error_sorted[len(error_sorted)//2]
print("median error: %f m" % median_error)

a = [x for x in error_results if editions[sheet_names[error_results.index(x)]] == "A"]
b = [x for x in error_results if editions[sheet_names[error_results.index(x)]] != "A"]
A_mean_error = sum(a)/len(a)
print("A mean error: %f m" % A_mean_error)
B_mean_error = sum(b)/len(b)
print("B mean error: %f m" % B_mean_error)

eds = [editions[s] for s in sheet_names_sorted]
colours = [ "r" if e=="A" else "b" for e in eds]

import matplotlib.pyplot as plt

plt.bar(sheet_names_sorted, error_sorted,color=colours)
plt.bar([0], [0],label="error, edition B",color="b")
plt.bar([0], [0],label="error, edition A",color="r")
plt.axhline(total_mean_error, c="g", linestyle="--", label="mean")
plt.annotate("%.0f" % total_mean_error,(0,total_mean_error + 50))
plt.axhline(median_error, c="r", label="median")
plt.annotate("%.0f" % median_error,(0,median_error + 50))
plt.xticks(range(len(sheet_names_sorted)),sheet_names_sorted,rotation=-90)
plt.legend()
plt.xlabel("sheet")
plt.ylabel("error [m]")
plt.show()